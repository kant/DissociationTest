---
title: "table 2"
author: "Rayna M Harris"
date: "4/16/2018"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
```

Import file with information about differentially expressed genes.

```{r}
dissociation <- read.csv("../results/01_dissociation_volcanoTreatment.csv", header = T, row.names = 1)
head(dissociation)
str(dissociation)
```

Filter out non-significant genes, sort by p-value, rename column, round to 2 decimal places. 

```{r}
DEGes <- dissociation %>%
  filter(color != "none") %>%
  arrange((padj))
DEGes$pvalue <- NULL # drop log pvalue columns
names(DEGes)[4] <- "upregulated in"
DEGes$lfc <- signif(DEGes$lfc, digits = 2)
DEGes$padj <- signif(DEGes$padj, digits = 3)
```


```{r}
write.csv(DEGes, file = "../results/SuppTable1.csv", row.names = F)
```

## Compare to Molecules implicated in hippocampal LTP



```{r}
# create list of candidate genes Sanes and Lichtman 1999 

sanesLichtman <- c("Gria1", "Gria2", 
                   "Grm1", "Grm4", "Grm5", "Grm7",
                   "Grin1", "Grin2a", "Grin2d", 
                   "Th", "Drd1",
                   "Adrb1", "Adrb2", 
                   "Adra1a", "Adra1b", "Adra1d", "Adra2c",
                   "Oprm1", "Oprk1", "Oprd1",
                   "Chrm1", "Chrm2", "Chrm3", "Chrm4", "Chrm5",
                   "Chrna1", "Chrna7", "Chrna3", "Chrnb1", "Chrnb2", "Chrnb3")
sanesLichtman[order(sanesLichtman)] # print list alphabetically

# confirm that all all Sanes and Lichtman genes are in the reference transcriptome
geneids <- read.csv("../data/geneids.csv", header = T)
sanesLichtman_reference <- geneids %>%
  dplyr::filter(gene %in% sanesLichtman) %>%
  dplyr::select(gene) %>%
  distinct() %>%
  arrange(gene) %>%
  droplevels()
sanesLichtman_reference <- sanesLichtman_reference[,c(1)]
sanesLichtman_reference

# identify which of the Sanes and Lichtman genes are present in my samples
sanesLichtman_present <- dissociation %>%
  dplyr::filter(gene %in% sanesLichtman) %>%
  droplevels()
sanesLichtman_present <- sanesLichtman_present[,c(1)]
sanesLichtman_present

# identify whichof the Sanes and Lichtman genes are differentially expressed in this analysis
sanesLichtman_DEGs <- DEGes %>%
  dplyr::filter(gene %in% sanesLichtman)
sanesLichtman_DEGs
```