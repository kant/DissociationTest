---
title: "table 2"
author: "Rayna M Harris"
date: "4/16/2018"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
```

Import file with information about differentially expressed genes.

```{r}
dissociation <- read.csv("../results/01_dissociation_volcanoTreatment.csv", header = T, row.names = 1)
head(dissociation)
str(dissociation)
```

Filter out non-significant genes, sort by p-value, rename column, round to 2 decimal places. 

```{r}
DEGes <- dissociation %>%
  filter(color != "none") %>%
  arrange((padj))
DEGes$pvalue <- NULL # drop log pvalue columns
names(DEGes)[4] <- "upregulated in"
DEGes$lfc <- signif(DEGes$lfc, digits = 2)
DEGes$padj <- signif(DEGes$padj, digits = 3)
```


```{r}
write.csv(DEGes, file = "../results/SuppTable1.csv", row.names = F)
```

## Compare to Molecules implicated in hippocampal LTP

List of 117 taken from Sanes and Lichtman 1999

```{r}
sanesLichtman <- c("Gria1", "Gria2", 
                   "Grim1", "Grim4", "Grim5", "Grim7",
                   "Grin1", "Grin2a", "Grin2d", 
                   "Th", "Drd1",
                   "Adrb1", "Adrb2", 
                   "Adra1a", "Adra1b", "Adra1d", "Adra2c", "Adra2d",
                   "Oprm1", "Oprk1", "Oprd1",
                   "Chrm1", "Chrm2", "Chrm3", "Chrm4", "Chrm5",
                   "Chrna1", "Chrna7", "Chrna3", "Chrnb1", "Chrnb2", "Chrnb3")

candidates <- dissociation %>%
  dplyr::filter(gene %in% sanesLichtman) %>%
  droplevels()
candidates <- candidates[,c(1)]
candidates


overlap <- DEGes %>%
  dplyr::filter(gene %in% sanesLichtman)
overlap
```