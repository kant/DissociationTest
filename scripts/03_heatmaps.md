    dissocation_DEGs <- read.csv("../results/heatmap_DEGs.csv", header = T, check.names = F)
    dissocation_df <-read.csv("../results/heatmap_colData.csv", header = T, row.names = 1)
    dissocation_df <- dissocation_df %>% dplyr::select(Subfield, Treatment)
    names(dissocation_DEGs)

    ##  [1] "100-CA1-1"             "100-CA1-2"            
    ##  [3] "100-CA1-3"             "100-CA3-1"            
    ##  [5] "100-CA3-4"             "100-DG-2"             
    ##  [7] "100-DG-3"              "101-CA1-1"            
    ##  [9] "101-CA1-2"             "101-CA1-3"            
    ## [11] "101-CA3-1"             "101-CA3-4"            
    ## [13] "101-DG-3"              "101-DG-4"             
    ## [15] "pvalTreatmentDISSHOMO" "padjTreatmentDISSHOMO"
    ## [17] "rownames"              "padjmin"

    head(dissocation_df)

    ##           Subfield Treatment
    ## 100-CA1-1      CA1      HOMO
    ## 100-CA1-2      CA1      HOMO
    ## 100-CA1-3      CA1      HOMO
    ## 100-CA3-1      CA3      HOMO
    ## 100-CA3-4      CA3      HOMO
    ## 100-DG-2        DG      HOMO

Here is the function I wrote to make two heatmaps, one a png and one a
pdf. The goal is to have the ~ top 30 genes that are differentially
expressed according to treatment.

    #colorpalette
    dissocation_colors <- list(Treatment = c(HOMO = (values=c("dodgerblue2")), 
                                             DISS = (values=c("firebrick1"))),
                               Subfield = c(CA1 = (values=c("#7570b3")),
                                            CA3 = (values=c("#1b9e77")), 
                                            DG = (values=c("#d95f02"))))

    # the function "Heatmaps" created a png and pdf of my desired heatmap

    # usage: name of matrix, color palette, lengend, title
    Heatmaps <- function(DEGs, ann_colors, df, main){
      
        myfile <-  paste("../figures/03_heatmaps/", substitute(DEGs), ".pdf", sep="")
      
      DEGs <- DEGs[order(DEGs$padjmin),]
      DEGs <- head(DEGs, 30)
      print(head(DEGs, 30))

     rownames(DEGs) <- DEGs$rownames
    drop.cols <-colnames(DEGs[,grep("padj|pval|rownames", colnames(DEGs))])
    DEGs <- DEGs %>% select(-one_of(drop.cols))
    DEGs <- as.matrix(DEGs)
    DEGs <- DEGs - rowMeans(DEGs)

      paletteLength <- 30
      myBreaks <- c(seq(min(DEGs), 0, length.out=ceiling(paletteLength/2) + 1), 
                  seq(max(DEGs)/paletteLength, max(DEGs), length.out=floor(paletteLength/2)))
      
    pheatmap(DEGs, show_colnames=F, show_rownames = T,
             annotation_col=df, annotation_colors = ann_colors, 
             annotation_row = NA, annotation_legend = TRUE,
             annotation_names_row = FALSE, annotation_names_col = FALSE,
             border_color = "grey60" ,
             color = viridis(30),
             clustering_method="average",
             breaks=myBreaks,
             clustering_distance_cols="correlation", 
             cluster_cols = F,
             main = main)  

    pheatmap(DEGs, show_colnames=F, show_rownames = T,
             annotation_col=df, annotation_colors = ann_colors, 
             annotation_row = NA, annotation_legend = TRUE,
             annotation_names_row = FALSE, annotation_names_col = TRUE,
             treeheight_row = 0, treeheight_col = 10,
             fontsize = 7, 
             border_color = "grey60" ,
             color = viridis(30),
             width=3.5, height=3.25,
             clustering_method="average",
             breaks=myBreaks,
             clustering_distance_cols="correlation", 
             cluster_cols = F,
             main = main,
             filename =  myfile)
    }

    Heatmaps(dissocation_DEGs, dissocation_colors, dissocation_df, " ")

    ##       100-CA1-1 100-CA1-2 100-CA1-3 100-CA3-1 100-CA3-4  100-DG-2 100-DG-3
    ## 15098  6.678939  6.455190  6.585972  8.021705  8.064552  8.194074 7.462165
    ## 6785   6.794036  6.431082  6.271558  6.650496  7.124864  6.557296 6.818165
    ## 12780  4.627409  4.682581  4.402139  4.847265  5.556670  4.942805 4.512461
    ## 1994   5.832386  5.187311  5.270995  5.448558  5.891398  5.629710 5.663644
    ## 3387   7.177887  6.356079  6.475490  7.079482  7.001363  6.618543 6.447274
    ## 3476   6.037049  5.730294  5.337531  5.989075  6.092079  5.642399 6.254192
    ## 3089   6.447653  6.014113  6.196623  7.578962  7.553177  8.117013 6.923477
    ## 7304   5.086677  5.198478  5.567193  5.748938  6.015899  5.661460 5.910482
    ## 8431   4.684613  4.704787  5.821971  7.053418  7.240844  7.495530 6.180669
    ## 2458   4.608960  3.759310  3.751154  4.376971  4.639427  4.661864 4.803783
    ## 8973   4.903701  4.614853  4.796532  5.121996  4.558878  4.970166 5.378022
    ## 14867  4.305365  4.261658  4.750790  6.527795  5.677166  6.611131 5.626321
    ## 9623   4.894100  4.784162  4.497302  4.999633  4.869186  4.542962 4.704596
    ## 13107  3.421744  3.581771  3.232148  3.371252  4.132322  3.495159 3.905093
    ## 2522   5.340415  5.883941  6.185763  6.378681  5.706299  6.485671 6.274939
    ## 2957   4.511400  4.392689  4.803760  6.773297  6.451795  7.020057 5.622021
    ## 7999   6.307229  5.580424  5.368546  5.683107  6.066981  5.833613 5.474854
    ## 10873  3.536999  3.185794  3.461266  3.621439  4.626295  4.346619 4.157604
    ## 10950  8.197626  7.916067  8.197970 10.129203 10.087866 10.383411 9.144721
    ## 8448   4.845908  4.997147  5.013705  7.294916  6.918571  7.521730 6.339534
    ## 10902  4.983362  5.471546  5.991482  5.728349  5.559299  5.669339 5.809946
    ## 7582   7.837546  7.898363  7.938664  8.040502  7.545658  8.947308 9.335770
    ## 8941   7.050153  6.555764  7.254896  9.300304  9.304802  9.053519 8.277872
    ## 10483  8.823579  8.983484  8.801556  9.237270  9.500806  9.312143 9.220215
    ## 13625  5.516769  5.105937  4.955874  5.565663  4.899730  5.727829 5.979085
    ## 10945  4.696961  4.200408  4.032974  5.348244  5.797690  6.291271 4.997149
    ## 9485   3.618046  5.306157  4.519926  5.914599  5.534871  5.963641 5.437147
    ## 10717  6.265664  6.077328  6.064875  7.317582  7.425536  7.364844 6.872592
    ## 15431  2.455953  3.394459  3.285130  3.048982  3.705145  3.271901 3.775430
    ## 3512   6.207898  5.570139  5.518497  5.905295  5.771442  5.470151 5.642099
    ##       101-CA1-1 101-CA1-2 101-CA1-3 101-CA3-1 101-CA3-4  101-DG-3
    ## 15098  7.907248  9.081181  9.465768  9.667106 10.024008  9.382194
    ## 6785   8.542570  8.909306  8.034152  7.697114  8.490398  8.148864
    ## 12780  6.646905  6.640343  7.222905  6.352124  6.157990  6.587095
    ## 1994   7.258444  7.473619  7.165815  6.501372  7.162034  7.012940
    ## 3387   8.356752  8.862487  8.438353  8.129927  8.587689  8.407205
    ## 3476   7.361882  8.149849  8.082421  7.310944  7.676637  7.780815
    ## 3089   7.313844  8.559543  8.786795  8.997386  9.464780  8.594700
    ## 7304   6.589388  8.438277  7.907140  6.424911  7.725533  7.351691
    ## 8431   6.051260  8.144525  8.632040  8.792534  9.296403  7.797460
    ## 2458   5.405455  7.303060  6.596218  5.549789  6.178931  4.369539
    ## 8973   6.434717  6.831226  6.674838  6.259688  7.106522  6.632664
    ## 14867  5.514358  7.180028  7.485012  7.293595  7.824323  7.285355
    ## 9623   6.089262  6.240292  6.527539  5.564987  5.365749  5.411023
    ## 13107  4.971787  6.167718  5.766789  4.231339  5.123144  3.769524
    ## 2522   7.410896  8.751719  7.469221  6.824263  7.660742  6.564128
    ## 2957   5.706858  7.486074  7.551711  8.160657  8.382774  7.729046
    ## 7999   7.315176  8.242020  7.504690  6.918436  7.979524  5.960904
    ## 10873  4.189891  7.392449  5.823648  5.190705  5.653129  8.262152
    ## 10950  8.944432 10.174151 11.395041 11.461422 12.167481 11.499125
    ## 8448   5.863539  7.642481  8.343836  8.258538  8.856698  8.843845
    ## 10902  6.814492  8.358698  7.264755  6.476434  7.518108  7.065922
    ## 7582   8.653407  9.265492  9.781276  8.976551  9.298621  9.738854
    ## 8941   7.823451  9.290911  9.943509 10.953240 10.684663 10.944587
    ## 10483 10.458559  9.849149  9.560151  9.859099  9.908936  9.116379
    ## 13625  6.166339  7.219558  7.462155  6.298145  6.475736  7.613242
    ## 10945  5.892753  6.376221  6.841794  6.897347  7.132391  4.781806
    ## 9485   5.671739  7.475817  7.211014  7.639958  7.613528  6.565427
    ## 10717  6.716386  7.996680  8.787636  8.319789  8.727496  8.385980
    ## 15431  4.734222  5.338804  5.313714  4.268023  4.434295  3.443164
    ## 3512   7.338130  7.935256  7.286387  6.720069  7.589266  7.926438
    ##        101-DG-4 pvalTreatmentDISSHOMO padjTreatmentDISSHOMO rownames
    ## 15098  8.450111          4.371346e-11          5.314245e-07      Trf
    ## 6785   7.514103          1.332342e-10          8.098639e-07     Hexb
    ## 12780  5.288673          2.274266e-10          9.216085e-07   Selplg
    ## 1994   6.493650          2.325214e-09          7.066907e-06     C1qb
    ## 3387   7.361839          4.728766e-09          9.581268e-06    Csf1r
    ## 3476   6.339071          4.322849e-09          9.581268e-06     Ctss
    ## 3089   7.991942          3.313910e-08          4.476356e-05      Cnp
    ## 7304   6.036578          2.755837e-08          4.476356e-05     Il1a
    ## 8431   8.043008          3.035901e-08          4.476356e-05      Mag
    ## 2458   4.518615          4.013123e-08          4.878753e-05     Cd14
    ## 8973   5.853311          5.850658e-08          6.466041e-05    Mpeg1
    ## 14867  6.395530          6.687712e-08          6.775210e-05  Tmem88b
    ## 9623   5.771282          7.312978e-08          6.838759e-05   Nfkbia
    ## 13107  3.769952          1.073194e-07          9.319157e-05  Slc15a3
    ## 2522   5.615347          1.232235e-07          9.986852e-05     Cd83
    ## 2957   6.086318          1.380022e-07          1.048558e-04   Cldn11
    ## 7999   5.578558          3.458524e-07          2.239322e-04   Laptm5
    ## 10873  6.338974          3.354031e-07          2.239322e-04     Plau
    ## 10950 10.249625          3.499804e-07          2.239322e-04     Plp1
    ## 8448   6.767767          3.857619e-07          2.318480e-04      Mal
    ## 10902  7.285834          4.004942e-07          2.318480e-04     Plek
    ## 7582   9.665208          5.787905e-07          3.198344e-04      Jun
    ## 8941   9.057475          8.351992e-07          4.414573e-04     Mobp
    ## 10483  9.097679          9.572107e-07          4.796366e-04   Pcsk1n
    ## 13625  6.944662          9.863384e-07          4.796366e-04    Socs3
    ## 10945  5.874721          1.167287e-06          5.457963e-04     Pllp
    ## 9485   6.076311          1.287107e-06          5.795321e-04    Ndrg1
    ## 10717  7.582320          1.577778e-06          6.850375e-04   Phldb1
    ## 15431  2.578011          1.960125e-06          8.216980e-04   Tyrobp
    ## 3512   6.646654          2.423521e-06          9.504111e-04   Cx3cr1
    ##            padjmin
    ## 15098 5.314245e-07
    ## 6785  8.098639e-07
    ## 12780 9.216085e-07
    ## 1994  7.066907e-06
    ## 3387  9.581268e-06
    ## 3476  9.581268e-06
    ## 3089  4.476356e-05
    ## 7304  4.476356e-05
    ## 8431  4.476356e-05
    ## 2458  4.878753e-05
    ## 8973  6.466041e-05
    ## 14867 6.775210e-05
    ## 9623  6.838759e-05
    ## 13107 9.319157e-05
    ## 2522  9.986852e-05
    ## 2957  1.048558e-04
    ## 7999  2.239322e-04
    ## 10873 2.239322e-04
    ## 10950 2.239322e-04
    ## 8448  2.318480e-04
    ## 10902 2.318480e-04
    ## 7582  3.198344e-04
    ## 8941  4.414573e-04
    ## 10483 4.796366e-04
    ## 13625 4.796366e-04
    ## 10945 5.457963e-04
    ## 9485  5.795321e-04
    ## 10717 6.850375e-04
    ## 15431 8.216980e-04
    ## 3512  9.504111e-04
